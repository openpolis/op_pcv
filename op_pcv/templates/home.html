{% extends "base.html" %}

{% block content %}


<script>

    var width = 250;
    var height = 180;
    var radius = 100;
    var grad=Math.PI/180;

    var label_array=[];
    label_array["Adesione"]={};
    label_array["Adesione"][0] = 'Non risponde';
    label_array["Adesione"][1] = 'Aderisce';
    label_array["Adesione"][2] = 'Non Aderisce';
    label_array["Parlamentari"]={};
    label_array["Parlamentari"][0] = 'Deputati';
    label_array["Parlamentari"][1] = 'Senatori';


    var totale=[];
    totale[0]=[], totale[1]=[];

    totale[0]["label"]=label_array["Parlamentari"][0];
    totale[0]['data']=[];
    totale[1]["label"]=label_array["Parlamentari"][1];
    totale[1]['data']=[];

    totale[0]["data"]=[
    {% for k,v in totale.0.items %}
        {{ v }},
    {% endfor %}
    ];

    totale[1]["data"]=[
    {% for k,v in totale.1.items %}
        {{ v }},
    {% endfor %}
    ];


    var color = d3.scale.category20();
{#    pie Camera#}
    var svg = d3.select("#graph").
                append("svg").
                attr("width", width).
                attr("height",height).
                append("g").
                attr("transform", "translate(" + radius*1.5 + "," + radius*1.5 +")");

    var arc = d3.svg.arc().innerRadius(radius - (radius/3)).outerRadius(radius - ((radius - radius/3)/10));

    var pie = d3.layout.pie().sort(null).startAngle(-90*grad).endAngle(90*grad);

    svg.selectAll("path").
            data(pie(totale[0]['data'])).
            enter().
            append("path").
            attr("d",arc).
            attr("fill",function(d, i) { return color(i); }).
            transition().
            duration(500).
            attrTween("d", sweep);


{#    pie Senato#}
    var svg = d3.select("#graph").
            append("svg").
            attr("width", width).
            attr("height",height).
            append("g").
            attr("transform", "translate(" + radius*1.5 + "," + radius*1.5 +")");

    var arc = d3.svg.arc().innerRadius(radius - (radius/3)).outerRadius(radius - ((radius - radius/3)/10));

    var pie = d3.layout.pie().sort(null).startAngle(-90*grad).endAngle(90*grad);

    svg.selectAll("path").
            data(pie(totale[1]['data'])).
            enter().
            append("path").
            attr("d",arc).
            attr("fill",
            function(d, i) { return color(i); }).transition().duration(500).attrTween("d", sweep);


    function sweep(a) {

        var i = d3.interpolate({startAngle: -90*grad, endAngle: -90*grad},a);
        return function(t) {
            return arc(i(t));
        };
    }

</script>

{% endblock %}
